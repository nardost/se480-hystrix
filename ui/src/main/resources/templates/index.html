<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments :: head-tag"></head>
<body>
    <header th:replace="fragments :: banner-and-navbar"></header>
    <div class="container">
        <nav class="navbar navbar-expand-lg navbar-light bg-white">
            <div class="collapse navbar-collapse d-flex justify-content-center" id="navbarTogglerDemo02">
                <form class="form-inline" action="#" th:action="@{/recommend}" th:object="${user}" method="post">
                    <div class="input-group input-group-lg">
                        <div class="input-group-prepend">
                            <span class="bg-white input-group-text text-info border-info" id="login-inputGroup-username"><i class="fas fa-at"></i></span>
                        </div>
                        <input type="text" name="username" th:field="*{username}" class="form-control border-info" placeholder="Username" aria-label="Username" aria-describedby="login-inputGroup-username">
                        <div class="input-group-prepend">
                            <span class="bg-white input-group-text text-info border-info border-left-0" id="login-inputGroup-password"><i class="fas fa-key"></i></span>
                        </div>
                        <input type="password" name="password" th:field="*{password}" class="form-control border-info" placeholder="Password" aria-label="Password" aria-describedby="login-inputGroup-password">
                        <div class="input-group-append">
                            <button class="btn btn-outline-info" type="submit" id="button-addon2"><i class="fas fa-film"></i> Get Movies</button>
                        </div>
                    </div>
                </form>
            </div>
        </nav>
    </div>
    <hr class="border-light"/>
    <main class="container">
        <div class="container">
            <!-- ${movies} looks undefined because of redirection in the controller.  -->
            <div th:if="${movies ne null}">
                <!-- th:with must appear only once per element, hence the very long line of definition. -->
                <div  class="row row-cols-1 row-cols-md-3"
                      th:each="index : ${#numbers.sequence(0, #lists.size(movies), 3)}"
                      th:with="themeTextColor=${theme == 'Kids' ? 'text-success' : theme == 'Teens' ? 'text-primary' : 'text-danger'}, themeButtonColor=${theme == 'Kids' ? 'btn-success' : theme == 'Teens' ? 'btn-primary' : 'btn-danger'}">
                    <div th:if="${index < #lists.size(movies)}" class="col mb-4">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title" th:inline="text"><i class="fas fa-film" th:classappend="${themeTextColor}"></i> [[${movies[index].title}]]</h5>
                                <p class="font-weight-light text-muted card-text" th:inline="text">
                                    This movies is rated for <span class="h4" th:classappend="${themeTextColor}">[[${theme}]]</span>
                                </p>
                                <div class="d-flex justify-content-start">
                                    <a href="#" class="btn" th:classappend="${themeButtonColor}"><i class="fas fa-play"></i> Play Movie</a>
                                </div>
                                <div class="d-flex justify-content-end">
                                    <span class="text-warning">
                                        <a href="#"><i class="fas fa-star text-warning"></i></a>
                                        <a href="#"><i class="fas fa-star text-warning"></i></a>
                                        <a href="#"><i class="fas fa-star-half-alt text-warning"></i></a>
                                        <a href="#"><i class="far fa-star text-warning"></i></a>
                                        <a href="#"><i class="far fa-star text-warning"></i></a>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div th:if="${index + 1 < #lists.size(movies) and movies[index + 1] ne null}" class="col mb-4">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title" th:inline="text"><i class="fas fa-film" th:classappend="${themeTextColor}"></i> [[${movies[index + 1].title}]]</h5>
                                <p class="font-weight-light text-muted card-text" th:inline="text">
                                    This movies is rated for <span class="h4" th:classappend="${themeTextColor}">[[${theme}]]</span>
                                </p>
                                <div class="d-flex justify-content-start">
                                    <a href="#" class="btn" th:classappend="${themeButtonColor}"><i class="fas fa-play"></i> Play Movie</a>
                                </div>
                                <div class="d-flex justify-content-end">
                                    <span class="text-warning">
                                        <a href="#"><i class="fas fa-star text-warning"></i></a>
                                        <a href="#"><i class="fas fa-star text-warning"></i></a>
                                        <a href="#"><i class="fas fa-star-half-alt text-warning"></i></a>
                                        <a href="#"><i class="far fa-star text-warning"></i></a>
                                        <a href="#"><i class="far fa-star text-warning"></i></a>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div th:if="${index + 2 < #lists.size(movies) and movies[index + 2] ne null}" class="col mb-4">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title" th:inline="text"><i class="fas fa-film" th:classappend="${themeTextColor}"></i> [[${movies[index + 2].title}]]</h5>
                                <p class="font-weight-light text-muted card-text" th:inline="text">
                                    This movies is rated for <span class="h4" th:classappend="${themeTextColor}">[[${theme}]]</span>
                                </p>
                                <div class="d-flex justify-content-start">
                                    <a href="#" class="btn" th:classappend="${themeButtonColor}"><i class="fas fa-play"></i> Play Movie</a>
                                </div>
                                <div class="d-flex justify-content-end">
                                    <span class="text-warning">
                                        <a href="#"><i class="fas fa-star text-warning"></i></a>
                                        <a href="#"><i class="fas fa-star text-warning"></i></a>
                                        <a href="#"><i class="fas fa-star-half-alt text-warning"></i></a>
                                        <a href="#"><i class="far fa-star text-warning"></i></a>
                                        <a href="#"><i class="far fa-star text-warning"></i></a>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </main>
    <hr class="border-light"/>
    <footer th:replace="fragments :: footer"></footer>
</body>
</html>